create or replace TRIGGER zaktualizuj_wolne_miejsca
 AFTER INSERT or UPDATE or DELETE on REZERWACJE for EACH ROW
 BEGIN
   if INSERTING then
   update WYCIECZKI
     set LICZBA_WOLNYCH_MIEJSC = LICZBA_WOLNYCH_MIEJSC -1
   where WYCIECZKI.ID_WYCIECZKI = :NEW.ID_WYCIECZKI;
    ELSEIF UPDATING then
        IF :NEW.STATUS='A' THEN
          update WYCIECZKI
      set LICZBA_WOLNYCH_MIEJSC = LICZBA_WOLNYCH_MIEJSC +1
      where WYCIECZKI.ID_WYCIECZKI = :NEW.ID_WYCIECZKI;
        END IF;
      IF :OLD.STATUS='A' THEN
         update WYCIECZKI
        set LICZBA_WOLNYCH_MIEJSC = LICZBA_WOLNYCH_MIEJSC -1
      where WYCIECZKI.ID_WYCIECZKI = :NEW.ID_WYCIECZKI;
      END IF;
     ELSE
        update WYCIECZKI
     set LICZBA_WOLNYCH_MIEJSC = LICZBA_WOLNYCH_MIEJSC +1
      where WYCIECZKI.ID_WYCIECZKI = :NEW.ID_WYCIECZKI;
   END IF ;
 END;


---